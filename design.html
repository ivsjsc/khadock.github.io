<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dock Design Portfolio - KhaDock.com Florida</title>
    <meta name="description" content="Explore innovative and custom boat dock designs by KhaDock.com. See our concepts for residential and commercial waterfront properties in Florida.">
    
    <meta property="og:title" content="KhaDock.com Design Portfolio - Custom Dock Solutions">
    <meta property="og:description" content="Browse KhaDock.com's portfolio of inspiring dock designs, from modern minimalist to luxurious multi-functional structures, tailored for Florida's coast.">
    <meta property="og:image" content="images/logo/logoicon.png"> 
    <meta property="og:url" content="https://KhaDock.com/design.html"> 
    <meta property="og:type" content="website">

    <link rel="icon" href="images/logo/logoicon.png" type="image/png"> 
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <link rel="stylesheet" href="css/styles.css"> 
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background-color: #f1f5f9; /* slate-100 */
        }
        .design-banner-bg {
             background-image: linear-gradient(rgba(12, 74, 110, 0.7), rgba(14, 116, 144, 0.8)), url('images/designs/khadockdesign.png'); 
             background-size: cover;
             background-position: center;
        }
        .text-shadow-strong {
            text-shadow: 0px 2px 5px rgba(0,0,0,0.5);
        }
        .design-card {
            transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
            background-color: white;
            border: 1px solid #e5e7eb; /* slate-200 */
        }
        .design-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px -15px rgba(0,0,0,0.2), 0 10px 20px -10px rgba(0,0,0,0.15);
        }
        .design-card-image-container {
            height: 270px; 
            overflow: hidden;
            background-color: #e2e8f0; 
        }
        .design-card img { 
            transition: transform 0.45s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
        }
        .design-card:hover img {
            transform: scale(1.08);
        }
        .design-tag {
            font-size: 0.65rem; 
            padding: 0.2rem 0.55rem;
            border-radius: 9999px; 
            font-weight: 600; 
            letter-spacing: 0.025em;
            text-transform: uppercase;
        }
        .design-process-step {
            transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid #e5e7eb; /* slate-200 */
        }
        .design-process-step:hover {
            background-color: #f0fdf4; 
            border-color: #22c55e; 
            transform: translateY(-5px);
        }
        .design-process-step .step-icon {
            transition: transform 0.3s ease, color 0.3s ease;
        }
        .design-process-step:hover .step-icon {
            transform: scale(1.15);
            color: #16a34a; /* green-600 */
        }
        .text-shadow { 
            text-shadow: 1px 1px 3px rgba(0,0,0,0.4);
        }
        main {
            padding-top: 5rem; /* Adjust if your header height changes (h-20 = 5rem) */
        }
    </style>
</head>
<body class="antialiased">

    <div id="header-placeholder"></div>

    <main>
        <section class="design-banner-bg text-white py-20 md:py-32" data-aos="fade-in">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h1 class="text-4xl sm:text-5xl md:text-6xl font-black mb-6 leading-tight text-shadow-strong" data-aos="fade-down" data-aos-delay="200">
                    KhaDock Design Studio
                </h1>
                <p class="text-lg sm:text-xl md:text-2xl mb-8 max-w-3xl mx-auto text-slate-100 text-shadow" data-aos="fade-up" data-aos-delay="400">
                    Crafting bespoke boat dock designs that blend innovation, functionality, and Florida's stunning coastal beauty. Your vision, expertly engineered.
                </p>
                <a href="#design-showcase" class="bg-sky-500 hover:bg-sky-600 text-white font-semibold py-3 px-8 rounded-lg text-lg shadow-md transition duration-300 transform hover:scale-105" data-aos="fade-up" data-aos-delay="600">
                    Explore Design Concepts
                </a>
            </div>
        </section>

        <section class="py-12 md:py-20 bg-white" id="design-thinking-video" data-aos="fade-up">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex flex-col lg:flex-row items-center gap-8 lg:gap-12">
                    <div class="w-full lg:w-3/5 xl:w-2/3" data-aos="zoom-in-right">
                        <div class="aspect-w-16 aspect-h-9 rounded-xl shadow-2xl overflow-hidden">
                            <video 
                                src="videos/design1.mp4" 
                                controls 
                                poster="images/designs/design1.jpg"
                                class="w-full h-full object-cover"
                                preload="metadata"
                            >
                                Your browser does not support the video tag.
                            </video>
                        </div>
                    </div>
                    <div class="w-full lg:w-2/5 xl:w-1/3" data-aos="fade-left" data-aos-delay="200">
                        <h2 class="text-2xl md:text-3xl font-bold text-sky-700 mb-5">Our Design Thinking</h2>
                        <ol class="list-decimal list-inside text-slate-700 space-y-3 text-base md:text-lg">
                            <li>
                                <span class="font-semibold text-slate-800">Site Analysis:</span> Assess waterfront, depth, environment.
                            </li>
                            <li>
                                <span class="font-semibold text-slate-800">Client Vision:</span> Collaborate on needs, lifestyle, aesthetics.
                            </li>
                            <li>
                                <span class="font-semibold text-slate-800">Concept Development:</span> Sketch ideas for function & safety.
                            </li>
                            <li>
                                <span class="font-semibold text-slate-800">Material Selection:</span> Choose durable, marine-grade options.
                            </li>
                            <li>
                                <span class="font-semibold text-slate-800">3D Visualization:</span> Create renderings for client clarity.
                            </li>
                            <li>
                                <span class="font-semibold text-slate-800">Refinement & Approval:</span> Finalize for construction.
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="py-16 md:py-24 bg-slate-50" id="design-showcase">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12 md:mb-16" data-aos="fade-up">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-900 mb-5">Explore Our Design Concepts</h2>
                    <p class="text-lg text-slate-700 max-w-2xl mx-auto">
                        A great dock is the heart of your waterfront life. At KhaDock.com, we blend your vision with Florida's unique environment, crafting designs that are stunning, durable, functional, and eco-conscious.
                    </p>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-8 md:gap-10 max-w-4xl mx-auto">
                    <div class="design-card rounded-xl shadow-lg overflow-hidden flex flex-col" data-aos="zoom-in-up" data-aos-delay="100">
                        <div class="design-card-image-container">
                            <img src="images/designs/design2.jpg" alt="Rustic Boathouse Dock Design Concept">
                        </div>
                        <div class="p-5 md:p-6 flex flex-col flex-grow">
                            <h3 class="text-lg md:text-xl font-semibold text-slate-800 mb-2">The Angler's Boathouse</h3>
                            <p class="text-slate-600 text-sm mb-4 line-clamp-3 flex-grow">Charming, rustic boathouse with natural wood, ample gear storage, and a protective covered slip.</p>
                            <div class="mt-auto pt-3 border-t border-slate-200">
                                <span class="design-tag bg-amber-100 text-amber-800 mr-1.5 mb-1 inline-block">Boathouse</span>
                                <span class="design-tag bg-lime-100 text-lime-800 mr-1.5 mb-1 inline-block">Wood</span>
                                <span class="design-tag bg-slate-100 text-slate-800 mb-1 inline-block">Fishing</span>
                            </div>
                        </div>
                    </div>

                    <div class="design-card rounded-xl shadow-lg overflow-hidden flex flex-col" data-aos="zoom-in-up" data-aos-delay="200">
                        <div class="design-card-image-container">
                            <img src="images/designs/design3.jpg" alt="Commercial Multi-Slip Dock Design Concept">
                        </div>
                        <div class="p-5 md:p-6 flex flex-col flex-grow">
                            <h3 class="text-lg md:text-xl font-semibold text-slate-800 mb-2">Community Marina Hub</h3>
                            <p class="text-slate-600 text-sm mb-4 line-clamp-3 flex-grow">Functional multi-slip marina layout for durability and easy access, with options for fueling and dockmaster facilities.</p>
                            <div class="mt-auto pt-3 border-t border-slate-200">
                                <span class="design-tag bg-indigo-100 text-indigo-800 mr-1.5 mb-1 inline-block">Commercial</span>
                                <span class="design-tag bg-teal-100 text-teal-800 mr-1.5 mb-1 inline-block">Multi-Slip</span>
                                <span class="design-tag bg-slate-100 text-slate-800 mb-1 inline-block">High-Traffic</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="design-card rounded-xl shadow-lg overflow-hidden flex flex-col" data-aos="zoom-in-up" data-aos-delay="100">
                        <div class="design-card-image-container">
                            <img src="images/designs/design4.jpg" alt="Eco-Friendly Pier Design Concept">
                        </div>
                        <div class="p-5 md:p-6 flex flex-col flex-grow">
                            <h3 class="text-lg md:text-xl font-semibold text-slate-800 mb-2">Eco-Conscious Pier</h3>
                            <p class="text-slate-600 text-sm mb-4 line-clamp-3 flex-grow">Sustainable design using recycled materials, permeable decking for marine life, and solar-powered lighting.</p>
                            <div class="mt-auto pt-3 border-t border-slate-200">
                                <span class="design-tag bg-green-100 text-green-800 mr-1.5 mb-1 inline-block">Eco-Friendly</span>
                                <span class="design-tag bg-cyan-100 text-cyan-800 mr-1.5 mb-1 inline-block">Permeable</span>
                                <span class="design-tag bg-yellow-100 text-yellow-800 mb-1 inline-block">Solar</span>
                            </div>
                        </div>
                    </div>

                    <div class="design-card rounded-xl shadow-lg overflow-hidden flex flex-col" data-aos="zoom-in-up" data-aos-delay="200">
                        <div class="design-card-image-container">
                            <img src="https://placehold.co/600x450/7c3aed/ffffff?text=Dockside+Bathroom+Remodel" alt="Dockside Bathroom Remodel Concept"> 
                        </div>
                        <div class="p-5 md:p-6 flex flex-col flex-grow">
                            <h3 class="text-lg md:text-xl font-semibold text-slate-800 mb-2">Dockside Bathroom Oasis</h3>
                            <p class="text-slate-600 text-sm mb-4 line-clamp-3 flex-grow">Transform your dockside convenience with a stylish and functional bathroom remodel, featuring marine-grade fixtures and weather-resistant finishes.</p>
                            <div class="mt-auto pt-3 border-t border-slate-200">
                                <span class="design-tag bg-purple-100 text-purple-800 mr-1.5 mb-1 inline-block">Remodel</span>
                                <span class="design-tag bg-blue-100 text-blue-800 mr-1.5 mb-1 inline-block">Comfort</span>
                                <span class="design-tag bg-gray-100 text-gray-800 mb-1 inline-block">Utility</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-16 md:py-24 bg-white" data-aos="fade-up">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12 md:mb-16" data-aos="fade-up">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-900 mb-5">Our Design Journey</h2>
                    <p class="text-lg text-slate-700 max-w-2xl mx-auto">
                        A collaborative and meticulous process to ensure your custom dock design exceeds every expectation.
                    </p>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
                    <div class="design-process-step bg-white p-6 rounded-xl shadow-lg text-center md:text-left" data-aos="fade-up" data-aos-delay="100">
                        <div class="step-icon text-sky-600 mb-4 text-4xl mx-auto md:mx-0"><i class="fas fa-comments"></i></div>
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">1. Consultation & Discovery</h3>
                        <p class="text-slate-600 text-sm leading-relaxed">We start by deeply understanding your vision, needs, and property specifics through thorough consultation.</p>
                    </div>
                    <div class="design-process-step bg-white p-6 rounded-xl shadow-lg text-center md:text-left" data-aos="fade-up" data-aos-delay="200">
                        <div class="step-icon text-sky-600 mb-4 text-4xl mx-auto md:mx-0"><i class="fas fa-drafting-compass"></i></div>
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">2. Concept & 3D Visualization</h3>
                        <p class="text-slate-600 text-sm leading-relaxed">Our designers craft initial concepts with 3D renderings, helping you visualize and refine your future dock.</p>
                    </div>
                    <div class="design-process-step bg-white p-6 rounded-xl shadow-lg text-center md:text-left" data-aos="fade-up" data-aos-delay="300">
                        <div class="step-icon text-sky-600 mb-4 text-4xl mx-auto md:mx-0"><i class="fas fa-cogs"></i></div>
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">3. Materials & Engineering</h3>
                        <p class="text-slate-600 text-sm leading-relaxed">Guiding you through material selection for durability and aesthetics, ensuring structural integrity and compliance.</p>
                    </div>
                    <div class="design-process-step bg-white p-6 rounded-xl shadow-lg text-center md:text-left" data-aos="fade-up" data-aos-delay="400">
                        <div class="step-icon text-sky-600 mb-4 text-4xl mx-auto md:mx-0"><i class="fas fa-file-alt"></i></div>
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">4. Permitting Assistance</h3>
                        <p class="text-slate-600 text-sm leading-relaxed">Navigating complex permits? We assist in ensuring all necessary approvals are obtained smoothly.</p>
                    </div>
                    <div class="design-process-step bg-white p-6 rounded-xl shadow-lg text-center md:text-left" data-aos="fade-up" data-aos-delay="500">
                        <div class="step-icon text-sky-600 mb-4 text-4xl mx-auto md:mx-0"><i class="fas fa-check-circle"></i></div>
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">5. Final Design & Blueprints</h3>
                        <p class="text-slate-600 text-sm leading-relaxed">Once refined and approved, we finalize the design, providing comprehensive blueprints for construction.</p>
                    </div>
                     <div class="design-process-step bg-sky-600 text-white p-6 rounded-xl shadow-xl flex flex-col justify-center items-center text-center" data-aos="fade-up" data-aos-delay="600">
                        <div class="step-icon text-white mb-4 text-4xl"><i class="fas fa-hard-hat"></i></div>
                        <h3 class="text-xl font-semibold mb-2">Construction Ready!</h3>
                        <p class="text-sky-100 text-sm leading-relaxed">Your approved design seamlessly transitions to our expert construction team.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="py-16 md:py-24 bg-sky-50" data-aos="fade-up">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-900 mb-6">✨ Generate Your Dream Dock Idea ✨</h2>
                <p class="text-lg text-slate-700 max-w-2xl mx-auto mb-8">
                    Describe your ideal dock: its purpose, style, materials, and any special features. Our AI will generate a unique design concept for you!
                </p>
                <div class="max-w-3xl mx-auto bg-white p-6 sm:p-8 rounded-xl shadow-lg border border-slate-200">
                    <textarea id="design-input" class="w-full p-3 sm:p-4 border border-slate-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-sky-500 mb-6 resize-y min-h-[100px] sm:min-h-[120px] text-slate-800 text-sm sm:text-base" 
                        placeholder="Example: 'A modern dock with a covered lounge area for entertaining, built with composite materials, suitable for a quiet Florida cove.'">
                    </textarea>
                    
                    <div class="flex justify-between items-center mb-4">
                        <button id="generate-design-btn" class="bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-6 sm:px-8 rounded-lg shadow-md transition duration-300 transform hover:scale-105 inline-flex items-center justify-center text-sm sm:text-base">
                            <i class="fas fa-magic mr-2 sm:mr-3"></i> Generate Design Idea
                        </button>
                        
                        <button id="translate-btn" class="hidden bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 inline-flex items-center justify-center text-sm sm:text-base">
                            <i class="fas fa-language mr-2"></i> Translate to Vietnamese
                        </button>
                    </div>

                    <div id="loading-indicator" class="mt-6 text-sky-600 hidden">
                        <i class="fas fa-spinner fa-spin mr-2"></i> <span id="loading-text">Generating your idea...</span>
                    </div>

                    <div id="design-output" class="mt-8 p-4 sm:p-6 bg-slate-50 border border-slate-200 rounded-lg text-left text-slate-700 leading-relaxed hidden prose max-w-none"></div>
                    <div id="error-message" class="mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg text-left hidden"></div>
                </div>
            </div>
        </section>
        
        <section class="py-16 md:py-24 bg-sky-700 text-white" data-aos="zoom-in-up">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-6">Ready to Design Your Dream Dock?</h2>
                <p class="text-lg md:text-xl mb-8 max-w-2xl mx-auto text-slate-100">
                    Our expert designers are eager to collaborate with you. Contact KhaDock.com today to start your custom dock design journey.
                </p>
                <a href="contact.html" class="bg-white text-sky-700 font-bold py-3.5 px-10 rounded-lg text-lg shadow-xl transition duration-300 transform hover:scale-105 hover:bg-slate-50">
                    Request a Design Consultation
                </a>
            </div>
        </section>
    </main>

    <div id="footer-placeholder"></div>
    
    <button id="scrollToTopBtn" title="Go to top" 
            class="hidden fixed bottom-8 right-8 bg-sky-500 hover:bg-sky-600 text-white 
                   w-12 h-12 md:w-14 md:h-14 rounded-full shadow-xl items-center justify-center 
                   focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75
                   transition-all duration-300 z-40 text-xl md:text-2xl">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="js/script.js" defer></script> 
    <script src="js/loadComponents.js" defer></script>
    <script>
        const basePrompt = {
            en: `As a creative dock design expert for KhaDock.com in Florida, generate a detailed and inspiring boat dock concept based on the following user input: "{INPUT}".
                Please provide the response in well-structured English, including:
                1. **Concept Name:** (A catchy, descriptive name)
                2. **Overall Vision:** (1-2 sentences describing the main idea and feel)
                3. **Key Features & Functionality:** (3-5 distinct features)
                4. **Suggested Materials:** (2-3 primary materials)
                5. **Aesthetic Style:** (1-2 sentences describing the look)
                6. **Best Suited For:** (1 sentence about ideal users/property)
                Ensure practical for Florida's environment. 150-250 words total.`,
            
            vi: `Với tư cách là chuyên gia thiết kế bến thuyền sáng tạo của KhaDock.com tại Florida, hãy tạo ra một ý tưởng bến thuyền chi tiết và đầy cảm hứng dựa trên yêu cầu sau: "{INPUT}".
                Vui lòng cung cấp phản hồi bằng tiếng Việt có cấu trúc rõ ràng, bao gồm:
                1. **Tên Ý Tưởng:** (Một tên gọi ấn tượng, mô tả)
                2. **Tầm Nhìn Tổng Thể:** (1-2 câu mô tả ý tưởng và cảm nhận chính)
                3. **Tính Năng & Chức Năng Chính:** (3-5 tính năng nổi bật)
                4. **Vật Liệu Đề Xuất:** (2-3 vật liệu chính)
                5. **Phong Cách Thẩm Mỹ:** (1-2 câu mô tả về diện mạo)
                6. **Phù Hợp Nhất Với:** (1 câu về đối tượng/khu vực lý tưởng)
                Đảm bảo phù hợp với môi trường Florida. Khoảng 150-250 từ.`
        };

        document.addEventListener('DOMContentLoaded', () => {
            AOS.init({
                duration: 700,
                offset: 80, 
                once: true,
                easing: 'ease-out-cubic',
            });

            const scrollToTopBtn = document.getElementById('scrollToTopBtn');
            if (scrollToTopBtn) {
                window.addEventListener('scroll', () => {
                    if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
                        scrollToTopBtn.classList.remove('hidden');
                        scrollToTopBtn.classList.add('flex'); 
                    } else {
                        scrollToTopBtn.classList.add('hidden');
                        scrollToTopBtn.classList.remove('flex');
                    }
                }, { passive: true });
                scrollToTopBtn.addEventListener('click', () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }

            const designInput = document.getElementById('design-input');
            const generateDesignBtn = document.getElementById('generate-design-btn');
            const loadingIndicator = document.getElementById('loading-indicator');
            const designOutput = document.getElementById('design-output');
            const errorMessage = document.getElementById('error-message');
            const translateBtn = document.getElementById('translate-btn');
            const loadingText = document.getElementById('loading-text');
            let originalText = '';
            let isTranslated = false;

            if (generateDesignBtn && designInput && loadingIndicator && designOutput && errorMessage && translateBtn) {
                generateDesignBtn.addEventListener('click', async () => {
                    const userPrompt = designInput.value.trim();
                    if (!userPrompt) {
                        errorMessage.textContent = 'Please describe your dream dock to generate an idea.';
                        errorMessage.classList.remove('hidden');
                        designOutput.classList.add('hidden');
                        return;
                    }

                    loadingIndicator.classList.remove('hidden');
                    generateDesignBtn.disabled = true;
                    generateDesignBtn.classList.add('opacity-75', 'cursor-not-allowed');
                    designOutput.classList.add('hidden');
                    errorMessage.classList.add('hidden');

                    try {
                        let chatHistory = [];
                        const prompt = basePrompt.en.replace('{INPUT}', userPrompt);
                        chatHistory.push({ 
                            role: "user", 
                            parts: [{ text: prompt }] 
                        });
                        
                        const payload = { contents: chatHistory };
                        const apiKey = ""; // API Key will be injected by Canvas environment
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=AIzaSyCweMMVnQeySpVY8_JX-hEkpv_GrVxgUno`;

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            let text = result.candidates[0].content.parts[0].text;
                            originalText = text; // Store original English text
                            
                            text = formatDesignText(text);
                            
                            designOutput.innerHTML = `<h4 class="font-semibold text-lg mb-3 text-sky-700">KhaDock AI Design Concept:</h4><div class="prose prose-sm sm:prose-base max-w-none">${text}</div>`;
                            designOutput.classList.remove('hidden');
                            translateBtn.classList.remove('hidden'); // Show translate button
                            isTranslated = false;
                        } else {
                            let apiErrorDetails = 'The AI could not generate a response for this input.';
                            if (result.error && result.error.message) {
                                apiErrorDetails = `API Error: ${result.error.message}`;
                            } else if (result.promptFeedback && result.promptFeedback.blockReason) {
                                apiErrorDetails = `Content was blocked: ${result.promptFeedback.blockReason}. Please rephrase your request.`;
                            }
                            errorMessage.textContent = `Could not generate design idea. ${apiErrorDetails}`;
                            errorMessage.classList.remove('hidden');
                            designOutput.classList.add('hidden');
                            console.error('Gemini API response structure unexpected or empty:', result);
                        }
                    } catch (error) {
                        errorMessage.textContent = `An error occurred: ${error.message}. Please check the console.`;
                        errorMessage.classList.remove('hidden');
                        designOutput.classList.add('hidden');
                        console.error('Error calling Gemini API:', error);
                    } finally {
                        loadingIndicator.classList.add('hidden');
                        generateDesignBtn.disabled = false;
                        generateDesignBtn.classList.remove('opacity-75', 'cursor-not-allowed');
                    }
                });

                translateBtn.addEventListener('click', async () => {
                    try {
                        if (!isTranslated) {
                            translateBtn.disabled = true;
                            loadingText.textContent = 'Translating...';
                            loadingIndicator.classList.remove('hidden');

                            const translationPrompt = `Translate the following dock design concept to Vietnamese, maintaining the formatting and structure:\n\n${originalText}`;
                            
                            const response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    contents: [{
                                        role: "user",
                                        parts: [{ text: translationPrompt }]
                                    }]
                                })
                            });

                            const result = await response.json();
                            if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                                let translatedText = result.candidates[0].content.parts[0].text;
                                translatedText = formatDesignText(translatedText);
                                
                                designOutput.innerHTML = `
                                    <h4 class="font-semibold text-lg mb-3 text-sky-700">Ý Tưởng Thiết Kế KhaDock:</h4>
                                    <div class="prose prose-sm sm:prose-base max-w-none">${translatedText}</div>
                                `;
                                
                                translateBtn.innerHTML = '<i class="fas fa-language mr-2"></i> Show English';
                                isTranslated = true;
                            }
                        } else {
                            const formattedOriginal = formatDesignText(originalText);
                            designOutput.innerHTML = `
                                <h4 class="font-semibold text-lg mb-3 text-sky-700">KhaDock AI Design Concept:</h4>
                                <div class="prose prose-sm sm:prose-base max-w-none">${formattedOriginal}</div>
                            `;
                            translateBtn.innerHTML = '<i class="fas fa-language mr-2"></i> Translate to Vietnamese';
                            isTranslated = false;
                        }
                    } catch (error) {
                        errorMessage.textContent = `Translation error: ${error.message}`;
                        errorMessage.classList.remove('hidden');
                    } finally {
                        translateBtn.disabled = false;
                        loadingIndicator.classList.add('hidden');
                    }
                });
            } else {
                console.error("One or more AI design generator elements not found on the page.");
            }
        });

        function formatDesignText(text) {
            return text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/^\s*-\s+(.*)/gm, '<li>$1</li>')
                .replace(/^\s*\d+\.\s+(.*)/gm, '<li>$1</li>')
                .replace(/(\<ul>|<\/ul>){0,1}(\<li\>.*?\<\/li\>)+(\<ul>|<\/ul>){0,1}/g, '<ul>$&</ul>')
                .replace(/\n/g, '<br>');
        }
    </script>
</body>
</html>
